{
  "author": {
    "name": "Holger Koser",
    "email": "holger.koser@sap.com"
  },
  "name": "hdb",
  "description": "SAP HANA Database Client for Node",
  "version": "0.2.0",
  "repository": {
    "type": "git",
    "url": "git://github.com/SAP/node-hdb.git"
  },
  "licenses": [
    {
      "type": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    }
  ],
  "keywords": [
    "sap",
    "hana",
    "database",
    "in-memory"
  ],
  "main": "./index.js",
  "scripts": {
    "test": "make test"
  },
  "engines": {
    "node": ">= 0.10.x"
  },
  "dependencies": {},
  "devDependencies": {
    "should": "~2.1.0",
    "mocha": "~1.14.0",
    "async": "~0.2.9",
    "debuglog": "~0.0.2",
    "readable-stream": "~1.1.9",
    "generic-pool": "~2.0.4",
    "fstream": "~0.1.24",
    "concat-stream": "~1.2.0"
  },
  "optionalDependencies": {},
  "readme": "SAP HANA Database Client for Node\r\n====================================\r\n\r\nA JavaScript client for Node implementing the \r\n[SAP HANA Database SQL Command Network Protocol](http://help.sap.com/hana/SAP_HANA_Database_SQL_command_network_protocol_en.pdf).\r\n\r\n[![Build Status](https://secure.travis-ci.org/SAP/node-hdb.png)](http://travis-ci.org/SAP/node-hdb)\r\n\r\nInstall\r\n-------\r\n\r\nInstall from npm:\r\n\r\n[![NPM](https://nodei.co/npm/hdb.png?compact=true)](https://npmjs.org/package/hdb)\r\n\r\nor clone from the [GitHub repository](https://github.com/SAP/node-hdb) to run tests and examples locally:\r\n\r\n```bash\r\ngit clone https://github.com/SAP/node-hdb.git\r\ncd node-hdb\r\nnpm install\r\n```\r\n\r\nIntroduction\r\n------------\r\n\r\nA very simple example how to use this module:\r\n\r\n```js\r\nvar hdb    = require('hdb');\r\nvar client = hdb.createClient({\r\n  host     : 'hostname',\r\n  port     : 30015,\r\n  user     : 'user',\r\n  password : 'secret'\r\n});\r\n\r\nclient.connect(function (err) {\r\n  if (err) {\r\n  \treturn console.error('Connect error', err);\r\n  }\t\r\n  client.exec('select * from DUMMY', function (err, rows) {\r\n\tclient.end();\r\n    if (err) {\r\n      return console.error('Execute error:', err);\r\n    }\r\n    console.log('Results:', rows);  \r\n  });\r\n});\r\n```\r\n\r\nAuthentication methods\r\n----------------------\r\n\r\nThe SAP HANA Database supports the following authentication methods:\r\n\r\n- **SCRAMSHA256** user/password based authentication method\r\n- _GSS_\r\n- _SAML_\r\n\r\nCurrently only the SCRAMSHA256 authentication method is supported.\r\n\r\n\r\nEstablishing a connection to the database\r\n-----------------------------------------\r\n\r\nIn order to be able to handle connection errors it is recommended to explicitly\r\nestablish a connection  using the `connect` method of the client object.\r\n\r\n```js\r\nvar hdb    = require('hdb');\r\nvar client = hdb.createClient({\r\n  host     : 'hostname',\r\n  port     : 30015,\r\n  user     : 'user',\r\n  password : 'secret'\r\n\t\r\n});\r\n\r\nclient.connect({\r\n  user     : 'somebody',\r\n  password : 'abc123'\r\n}, function (err) {\r\n  if (err) {\r\n    return console.error('Client connection error:', err);\r\n  } \r\n  console.log('Client connected!');  \r\n});\r\n```\r\nIf user and password are specified it will override the defaults of the client. It is possible to disconnect and reconnect with a different user on the same client instance and the same network connection.    \r\n \r\nDirect Statement Execution \r\n--------------------------\r\n\r\nDirect statement execution is the simplest way to execute SQL statements.\r\nThe only input parameter is the SQL command to be executed.\r\nGenerally we return the statement execution results using callbacks.\r\nFor callbacks we follow the convention described in the\r\n[Node.js Style Guide](http://nodeguide.com/style.html#callbacks) \r\nto reserve the first parameter of any callback for an optional error object.\r\nThe type of returned result depends on the kind of statement. \r\n\r\n### DDL Statement\r\n\r\nIn the case of a DDL Statement nothing is returned.\r\n\r\n```js\r\nclient.exec('create table TEST.NUMBERS (a int, b varchar(16))', function (err) {\r\n  if (err) {\r\n    return console.error('Error:', err);\r\n  } \r\n  console.log('Table TEST.NUMBERS has been created');  \r\n});\r\n```\r\n\r\n### DML Statement\r\n\r\nIn the case of a DML Statement the number of `affectedRows` is returned.\r\n\r\n```js\r\nclient.exec('insert into TEST.NUMBERS values (1, \\'one\\')', function (err, affectedRows) {\r\n  if (err) {\r\n    return console.error('Error:', err);\r\n  } \r\n  console.log('Number of affected rows:', affectedRows);  \r\n});\r\n```\r\n\r\n### Query\r\n\r\nThe `exec` function is a convinient way to completely retrieve the result of a query. In this case all selected `rows` are fetched and returned in the callback. The `resultSet` is automatically closed and all `Lobs` are completely read and returned as Buffer objects. If streaming of the results is required you will have to use the `execute` function. This is described in section [Streaming results](#streaming-results).\r\n\r\n```js\r\nclient.exec('select A, B from TEST.NUMBERS oder by A', function(err, rows) {\r\n  if (err) {\r\n    return console.error('Error:', err);\r\n  } \r\n  console.log('Rows:', rows);  \r\n});\r\n```\r\n\r\nPrepared Statement Execution\r\n----------------------------\r\n\r\n###  Prepare a Statement \r\n\r\nThe client returns a `statement` object which can be executed multiple times.\r\n\r\n```js\r\nclient.prepare('call * from DUMMY where X = ?', function (err, statement){\r\n  if (err) {\r\n    return console.error('Error:', err);\r\n  } \r\n  // do something with the statement\r\n  console.log('StatementId', statement.id);\r\n});\r\n```\r\n\r\n### Execute a Statement \r\n\r\nThe execution of a prepared statement is similar to the direct statement execution on the client. The difference is that the first parameter of `exec` function is an array with positional `parameters`. In case of named parameters it can also be an `parameters` object.   \r\n\r\n```js\r\nstatement.exec([1], function (err, rows) {\r\n  if (err) {\r\n    return console.error('Error:', err);\r\n  }\r\n  console.log('Rows:', rows);  \r\n});\r\n```\r\n\r\nIf you use the `execute` instead of `exec` function the `resultSet` is returned in the callback like in direct query execution above. \r\n\r\n### Calling Stored Procedures\r\n\r\nIf you have for example the following stored procedure:\r\n\r\n```sql\r\ncreate procedure PROC_DUMMY (in a int, in b int, out c int, out d DUMMY, out e TABLES)\r\n  language sqlscript\r\n  reads sql data as\r\n  begin\r\n    c := :a + :b;\r\n    d = select * from DUMMY;\r\n    e = select * from TABLES;\r\n  end\r\n```\r\nyou can call it via a prepared statement. \r\nThe second argument is always an object with the scalar parameters.\r\nIf there are no scalar parameters, an empty object ``{}`` will be returned.\r\nThe following arguments are the `resultSets`.\r\n\r\n```js\r\nclient.prepare('call PROC_DUMMY (?, ?, ?, ?, ?)', function(err, statement){\r\n  if (err) {\r\n    return console.error('Prepare error:', err);\r\n  }  \r\n  statement.exec({\r\n    A: 3, \r\n    B: 4\r\n  }, function(err, parameters, dummyRows, tableRows) {\r\n    if (err) {\r\n      return console.error('Exec error:', err);\r\n    }\r\n    console.log('Parameters:', parameters);\r\n    console.log('Dummies:', dummyRows);\r\n    console.log('Tables:', tableRows);\r\n  });\r\n});\r\n```\r\n\r\n### Drop Statement\r\n\r\nTo drop the statement simply call\r\n\r\n```js\r\nstatement.drop(function(err){\r\n  if (err) {\r\n    return console.error('Drop error:', err);\r\n  }  \r\n  console.log('Statement dropped');\r\n});\r\n```\r\nThe callback is optional in this case.\r\n\r\nStreaming results\r\n---------------\r\n\r\nIf you use the `execute` function of client or statement instead of the `exec` function, a `resultSet` object is returned in the callback instead of an array of all rows. The `resultSet` object allows you to create an object based `row` stream or an array based stream of `rows` which can be piped to an writer object. Don't forget to close the `resultSet` if you use the `execute` function. \r\n \r\n```js\r\nclient.execute('select A, B from TEST.NUMBERS oder by A', function(err, rs) {\r\n  if (err) {\r\n    return console.error('Error:', err);\r\n  } \t\r\n  rs.setFetchSize(2048);\r\n  rs.createObjectStream()\r\n    .pipe(new MyWriteStream())\r\n    .on('finish', function (){\r\n      if (!rs.closed) {\r\n       rs.close();\r\n      }\r\n    });\r\n});\r\n```\r\nTake a look at the example [app4](https://github.com/SAP/node-hdb/blob/master/examples/app4.js) for further details. \r\n\r\nTransaction handling\r\n---------------\r\n\r\nThe default behavior is that each statement is automatically commited. If you want to manually control `commit ` and `rollback` of a transaction, you can do this by calling `setAutoCommit(false)` on the client object.\r\n\r\n```js\r\nfunction execTransaction(cb) {\r\n  client.setAutoCommit(false);\r\n  async.series([\r\n    client.exec.bind(client, \"insert into NUMBERS values (1, 'one')\"),\r\n    client.exec.bind(client, \"insert into NUMBERS values (2, 'two')\")\r\n  ], function (err) {\r\n    if (err) {\r\n      client.rollback(function(err){\r\n        if (err) {\r\n          err.code = 'EROLLBACK';\r\n          return cb(err);\r\n        }\r\n        cb(null, false);\r\n      });\r\n    } else {\r\n      client.commit(function(commitError){\r\n        if (err) {\r\n          err.code = 'ECOMMIT';\r\n          return cb(err);\r\n        }\r\n        cb(null, true);\r\n      });\r\n    }\r\n    client.setAutoCommit(true);\r\n  });\r\n}\r\n\r\nexecTransaction(function(err, ok){\r\n  if (err) {\r\n    return console.error('Commit or Rollback error', err);\r\n  }\r\n  if (ok) {\r\n    console.log('Commited'); \r\n  } else {\r\n    console.log('Rolled back'); \r\n  }\r\n})\r\n\r\n```\r\n\r\nTake a look at the example [tx1](https://github.com/SAP/node-hdb/blob/master/examples/tx1.js) for further details. \r\n\r\nStreaming Large Objects (LOBs)\r\n-------------\r\n\r\n### Read Streams\r\n\r\nReading large object as stream can be done if you use the `execute` method of client or statement. In this case for all LOB columns a [Lob](https://github.wdf.sap.corp/d021332/node-hdb/blob/master/lib/protocol/Lob.js#L74-L89) object is returned. You can call `createReadStream` or `read` in order create a readable stream or to read the LOB completely. \r\n\r\n### Write Streams\r\n\r\nWriting large objects is automatically done. You just have to pass instance of [`Readable`](http://nodejs.org/api/stream.html#stream_class_stream_readable_1) or a Buffer oobject as parameter.\r\n\r\nTake a look at the example [app7](https://github.com/SAP/node-hdb/blob/master/examples/app7.js) for further details. \r\n\r\nRunning tests\r\n-------------\r\n\r\nTo run the unit tests for _hdb_ simply run:\r\n\r\n```bash\r\nmake test-unit\r\n```\r\n\r\nTo run the unit tests as well as acceptance tests for _hdb_ you have to run:\r\n\r\n```bash\r\nmake test\r\n```\r\n\r\nFor the acceptance tests a database connection has to be established. Therefore you need to copy the configuration template [config.tpl.json](https://github.com/SAP/node-hdb/blob/master/test/lib/config.tpl.json) in the ```test/lib``` folder to ```config.json``` and change the connection data to yours. If the ```config.json``` file does not exist a local mock server is started.\r\n\r\n\r\nRunning examples\r\n----------------\r\n\r\nAlso, for the examples you need a valid a ```config.json``` in the ```test/lib``` folder. \r\n\r\n\r\n- [app1](https://github.com/SAP/node-hdb/blob/master/examples/app1.js): Simple query. \r\n- [app2](https://github.com/SAP/node-hdb/blob/master/examples/app2.js): Fetch rows from `ResultSet`.\r\n- [app3](https://github.com/SAP/node-hdb/blob/master/examples/app3.js): Streaming rows `createObjectStream()`.\r\n- [app4](https://github.com/SAP/node-hdb/blob/master/examples/app4.js): Pipe row into JSON-Transform and to `stdout`.\r\n- [app5](https://github.com/SAP/node-hdb/blob/master/examples/app5.js): Stream XS repository into the filesystem.\r\n- [app6](https://github.com/SAP/node-hdb/blob/master/examples/app6.js): Stream from the filesystem into a db table.\r\n- [app7](https://github.com/SAP/node-hdb/blob/master/examples/app7.js): Insert a row with a large image into a db table (uses WriteLobRequest and Transaction internally).\r\n- [call1](https://github.com/SAP/node-hdb/blob/master/examples/call1.js): Call stored procedure. \r\n- [call2](https://github.com/SAP/node-hdb/blob/master/examples/call2.js): Call stored procedure with lob input and output parameter.\r\n- [tx1](https://github.com/SAP/node-hdb/blob/master/examples/tx1.js): Transaction handling (shows how to use commit and rollback).  \r\n- [csv](https://github.com/SAP/node-hdb/blob/master/examples/csv.js): Stream a db table into csv file.\r\n- [server](https://github.com/SAP/node-hdb/blob/master/examples/server.js): Stream rows into http response `http://localhost:1337/{schema}/{tablename}?top={top}`\r\n\r\nTo call e.g. the first example:\r\n\r\n```bash\r\nnode examples/app1\r\n```\r\n\r\nTodo\r\n----\r\n* Improve documentation of the client api    \r\n* Improve error handling\r\n* SAML Authentication support\r\n* Enhance tests\r\n* ...\r\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/SAP/node-hdb/issues"
  },
  "_id": "hdb@0.2.0",
  "dist": {
    "shasum": "a21168cfb98a1e89c69c2012df35ecbf155b482d"
  },
  "_from": "hdb@",
  "_resolved": "https://registry.npmjs.org/hdb/-/hdb-0.2.0.tgz"
}
